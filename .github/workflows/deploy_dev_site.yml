
name: Deploy Development of CLC

# Controls when the workflow will run
'on':
  #triggers the workflow whenever a push is made to the main branch
  push:
    branches:
      - development
  pull_request:
    branches:
      - development

jobs:
  #this workfloe has only one job
  deploy_to_dev_site:
    runs-on: ubuntu-latest
    # env:
    #   NODE_ENV: development
    #   PRODUCT_KEY: prod_Jxz6h1dBbC93P8
    #   PRODUCT_KEY_DEV: prod_ItM3Rl00ARmZwI
    #   STRIPE_DEVELOPMENT_KEY: sk_test_V09bhnBnCKBDwLD6gMha7WgG
    #   STRIPE_PRODUCTION_KEY: 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
    #   DEV_PRICE_ONE_KEY: price_1IoVlXAT9ya87fpTZmwFPg4s
    #   DEV_PRICE_ONE_KEY_YEAR: price_1LRsejAT9ya87fpTaALhNRUX
    #   PROD_PRICE_ONE_KEY: price_1JK37pAT9ya87fpTjdhp4YMc
    #   PROD_PRICE_ONE_KEY_YEAR: price_1JK37pAT9ya87fpTjdhp4YMc
    #   DEV_PRICE_TWO_KEY: price_1IHZKzAT9ya87fpT4uf93joS
    #   DEV_PRICE_TWO_KEY_YEAR: price_1LRseLAT9ya87fpTT3hNL9xG
    #   PROD_PRICE_TWO_KEY: price_1JK37pAT9ya87fpT2bvLdmi8
    #   PROD_PRICE_TWO_KEY_YEAR: price_1JK37pAT9ya87fpT2bvLdmi8
    #   DEV_PRICE_TEST: price_1IoVlXAT9ya87fpTZmwFPg4s
    #   DEV_PRICE_YEAR_TEST: price_1LRsejAT9ya87fpTaALhNRUX
    #   PROD_PRICE_TEST: price_1JPdYgAT9ya87fpTBogwLuNz
    #   SECRET_KEY: clc_armin_project
    #   REPORT_TIME: 17-00
    #   UPWD_UID: UVCIqxRsb8WhI6AKxVUmuanqefi1
    #   UPWD_EMAIL: universalPWDUser@gmail.com
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v3
        with:
          node-version: 14.18.0
      # this install the dependencies specified in your package.json file into the current workflow
      - name: Install dependencies
        # navigates to your functions folder and install the dependencies
        run: |
          cd functions
          sudo mv .env.dev .env
          yarn install
        # If your firebase cloud functions project uses firebase-admin 
        # you need to create a config file used to initialize your project
        # the below task creates a config.json file in your functions directory
      - name: Deploy to dev site
        uses: w9jds/firebase-action@master
        with:
          args: deploy --only functions
        env:
          FIREBASE_TOKEN: 1//0cl4PB84ArIB7CgYIARAAGAwSNwF-L9Irtq5CTk_m4VcGqk2T4ILl78mrS3BH80i9QUC-XOXzh_Ecf_X0wzZVDvqjxNfr3gx3cbg
